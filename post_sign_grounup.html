<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>签到-帮助</title>
<meta name="viewport" content="initial-scale=1, maximum-scale=1">
<link rel="shortcut icon" href="/favicon.ico">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black">
<link rel="stylesheet" href="css/light7.min.css">
<link rel="stylesheet" href="css/common.css" />
<link rel="stylesheet" href="css/index.css" />
</head>
<body>
    <!-- page 容器 -->
    <div class="page">
        <header class="bar bar-nav">
            <a href="" class="s_left"></a>
            <h1 class="title">成长值详情</h1>
        </header>
        <!-- 签到页面 -->
        <div class="content page-content infinite-scroll" data-distance="100">
            <div class="sign_top">
                <img src="images/groun_bg.png" width="100%"/>
                <div class="grounup_bg">
                    <div class="small_fish">
                        <img src="images/test1111.png" width="100%"/>
                    </div>
                    <p class="groun_txt">得距离下一新形象，还有 <span><i>40</i>成长值</span></p>
                    <div class="progress_line">
                        <div class="progress_box"><p class="progress_nr"></p></div>
                    </div>
                    <p class="pro_text"><span id="p_value1">10</span>/<span id="p_value2">140</span></p>
                </div>
            </div>
            <div class="sign_data">
                <div class="data_line cl">
                    <span class="z txt1">抢地盘</span>
                    <span class="z txt2">11-20</span>
                    <span class="y txt3">+15</span>
                </div>
                <div class="data_line cl">
                    <span class="z txt1">抢地盘</span>
                    <span class="z txt2">11-20</span>
                    <span class="y txt3">+15</span>
                </div>
                <div class="data_line cl">
                    <span class="z txt1">抢地盘</span>
                    <span class="z txt2">11-20</span>
                    <span class="y txt3">+15</span>
                </div>
                <div class="data_line cl">
                    <span class="z txt1">抢地盘</span>
                    <span class="z txt2">11-20</span>
                    <span class="y txt3">+15</span>
                </div>
                <div class="data_line cl">
                    <span class="z txt1">抢地盘</span>
                    <span class="z txt2">11-20</span>
                    <span class="y txt3">+15</span>
                </div>
                <div class="data_line cl">
                    <span class="z txt1">抢地盘</span>
                    <span class="z txt2">11-20</span>
                    <span class="y txt3">+15</span>
                </div>
                <div class="data_line cl">
                    <span class="z txt1">抢地盘</span>
                    <span class="z txt2">11-20</span>
                    <span class="y txt3">+15</span>
                </div>
                <div class="data_line cl">
                    <span class="z txt1">抢地盘</span>
                    <span class="z txt2">11-20</span>
                    <span class="y txt3">+15</span>
                </div>

            </div>
            <div class="infinite-scroll-preloader">
                <div class="preloader"></div>
            </div>
        </div>
    </div>
    <script type='text/javascript' src='js/jquery.min.js' charset='utf-8'></script>
    <script type='text/javascript' src='js/light7.min.js' charset='utf-8'></script>
    <script>
    var p_value1 = parseInt($('#p_value1').text());
    var p_value2 = parseInt($('#p_value2').text());
    var p_pencent =(p_value1/p_value2)*100;
    $('.progress_nr').width(p_pencent+'%');
    /*加载更多*/
    var loading = false;
    var maxItems = 100;

    var itemsPerLoad = 2;

    function addItems(number, lastIndex) {
        var html = '';
        for (var i = lastIndex + 1; i <= lastIndex + number; i++) {
            html =  '<div class="data_line cl">'+
                        '<span class="z txt1">抢地盘</span>'+
                        '<span class="z txt2">11-20</span>'+
                        '<span class="y txt3">+15</span>'+
                    '</div>';
        }
        $('.sign_data').append(html);

    }
    addItems(itemsPerLoad, 0);
    var lastIndex = 20;
    $(document).on('infinite', '.infinite-scroll',function() {

        // 如果正在加载，则退出
        if (loading) return;

        // 设置flag
        loading = true;

        setTimeout(function() {
            loading = false;

            if (lastIndex >= maxItems&& lastIndex <= 5) {
                $.detachInfiniteScroll($('.infinite-scroll'));
                $('.infinite-scroll-preloader').remove();
                return;
            }
            /*if($('.data_line').length>7){
                $('.infinite-scroll-preloader').show();
            }
*/
            addItems(itemsPerLoad, lastIndex);
            lastIndex = $('.data_line').length;
        }, 1000);
    });
    $.init();
    </script>
</body>
</html>
